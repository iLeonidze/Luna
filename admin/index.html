<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<link rel="apple-touch-icon" sizes="76x76" href="assets/img/apple-icon.png" />
	<link rel="icon" type="image/png" href="assets/img/favicon.png" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

	<title>Luna Admin Panel</title>

	<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta name="viewport" content="width=device-width" />

    <!-- Bootstrap core CSS     -->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet" />

    <!--  Material Dashboard CSS    -->
    <link href="assets/css/material-dashboard.css" rel="stylesheet"/>

    <!--  CSS for Demo Purpose, don't include it in your project     -->
    <link href="assets/css/demo.css" rel="stylesheet" />

    <!--     Fonts and icons     -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,700,300|Material+Icons' rel='stylesheet' type='text/css'>
</head>

<body>
	<style>
		.main-panel > .content {
			 margin-top: 0px;
		}
		.container-fluid{
			visibility: visible;
		}
		.container-fluid.hidden{
			visibility: hidden;
		}
		.animation-transition-general, .sidebar .nav li > a, .off-canvas-sidebar .nav li > a {
			-webkit-transition: all 100ms linear;
			-moz-transition: all 100ms linear;
			-o-transition: all 100ms linear;
			-ms-transition: all 100ms linear;
			transition: all 100ms linear;
		}
		.nav-pills:not(.nav-pills-icons) > li > a {
			border-radius: 5px;
		}
	</style>

	<div class="wrapper">

	    <div class="sidebar" data-color="purple" data-image="../assets/img/sidebar-1.jpg">
			<!--
		        Tip 1: You can change the color of the sidebar using: data-color="purple | blue | green | orange | red"

		        Tip 2: you can also add an image using data-image tag
		    -->

			<div class="logo">
				<a href="https://github.com/iLeonidze/Luna" class="simple-text">
					<i class="material-icons">brightness_2</i> Luna Marvellous
				</a>
			</div>

	    	<div class="sidebar-wrapper">
	            <ul class="nav">
	                <li class="navigation_statistics">
	                    <a href="#statistics" onclick="switchPage('statistics');">
							<i class="material-icons">assignment</i>
	                        <p>Статистика</p>
	                    </a>
	                </li>
	                <li class="navigation_pages">
	                    <a href="#pages" onclick="switchPage('pages');">
							<i class="material-icons">insert_drive_file</i>
	                        <p>Страницы</p>
	                    </a>
	                </li>
	                <li class="navigation_navigation">
	                    <a href="#navigation" onclick="switchPage('navigation');">
							<i class="material-icons">wrap_text</i>
	                        <p>Навигация</p>
	                    </a>
	                </li>
	                <li class="navigation_development">
	                    <a href="#development" onclick="switchPage('development');">
							<i class="material-icons">code</i>
	                        <p>Разработка</p>
	                    </a>
	                </li>
	                <li class="navigation_datamodel">
	                    <a href="#datamodel" onclick="switchPage('datamodel');">
	                        <i class="material-icons">bubble_chart</i>
	                        <p>Дата-модель</p>
	                    </a>
	                </li>
	                <li class="navigation_settings">
	                    <a href="#settings" onclick="switchPage('settings');">
							<i class="material-icons">settings</i>
	                        <p>Настройки</p>
	                    </a>
	                </li>
	                <li class="navigation_users">
	                    <a href="#users" onclick="switchPage('users');">
							<i class="material-icons">person</i>
							<p>Пользователи</p>
	                    </a>
	                </li>
					<li class="active-pro">
	                    <a href="#exit"  onclick="exit();">
							<i class="material-icons">exit_to_app</i>
	                        <p>Выйти</p>
	                    </a>
	                </li>
	            </ul>
	    	</div>
	    </div>

	    <div class="main-panel">

			<div class="content">
				<div class="container-fluid hidden" id="page_statistics">
					Статистика
				</div>
				<div class="container-fluid hidden" id="page_pages">
					<div class="row">
						<div class="col-md-8">
							<div class="card">
								<div class="card-header" data-background-color="purple">
									<h4 class="title">Список страниц с контентом сайта</h4>
									<p class="category">Здесь вы можете найти необходимую страницу, отредактировать ее или добавить новую.</p>
								</div>
								<div class="card-content table-responsive">
									<div class="row">
										<div class="col-md-12">
											<button type="submit" class="btn btn-primary btn-sm">Новая страница</button>
											<button type="submit" class="btn btn-sm">Сбросить фильтр</button>
										</div>
									</div>
									<table class="table">
										<thead class="text-primary">
										<th>Путь</th>
										<th>Название</th>
										<th>Тип</th>
										<th>Изменена</th>
										</thead>
										<tbody>
										<tr>
											<td>Dakota Rice</td>
											<td>Niger</td>
											<td>Oud-Turnhout</td>
											<td class="text-primary">$36,738</td>
										</tr>
										</tbody>
									</table>

								</div>
							</div>
						</div>
						<div class="col-md-4">
							<div class="card">
								<div class="card-header" data-background-color="purple">
									<h4 class="title">Фильтр списка</h4>
									<p class="category">Измените фильтр, чтобы увидеть подходящие страницы.</p>
								</div>
								<form class="card-content">
									<form>
										<div class="row">
											<div class="col-md-12">
												<div class="title">
													<h4>Тип страниц</h4>
												</div>

												<ul class="nav nav-pills nav-pills-primary" role="tablist" id="pagesPagesTypesList">
													<!--
                                                        color-classes: "nav-pills-primary", "nav-pills-info", "nav-pills-success", "nav-pills-warning","nav-pills-danger"
                                                    -->
													<li style="opacity:0;">
														<a role="tab" data-toggle="tab">
															<i class="material-icons">dashboard</i>
															1
														</a>
													</li>
												</ul>
											</div>
											<div class="col-md-12">
												<div class="title">
													<h4>Диапазон</h4>
												</div>

												<div id="sliderRegular" class="slider"></div>
												<div id="sliderDouble" class="slider slider-info"></div>
											</div>
										</div>

									</form>
								</form>
							</div>
						</div>
					</div>
				</div>
				<div class="container-fluid hidden" id="page_navigation">
					Навигация
				</div>
				<div class="container-fluid hidden" id="page_development">
					Разработка
				</div>
				<div class="container-fluid hidden" id="page_datamodel">
					Дата-модель
				</div>
				<div class="container-fluid hidden" id="page_settings">
					Настройки
				</div>
				<div class="container-fluid hidden" id="page_users">
					Пользователи
				</div>
			</div>

			<footer class="footer">
				<div class="container-fluid">
					<nav class="pull-left">
						<ul>
							<li>
								<a href="#">
									Вы вошли как Леонид Федотов
								</a>
							</li>
						</ul>
					</nav>
					<p class="copyright pull-right">
						&copy; <script>document.write(new Date().getFullYear())</script> <a href="https://github.com/iLeonidze/Luna">Luna CMS</a>, made with love for a better web
					</p>
				</div>
			</footer>
		</div>
	</div>

</body>

	<!--   Core JS Files   -->
	<script src="assets/js/jquery-3.1.0.min.js" type="text/javascript"></script>

	<script src="assets/js/bootstrap.min.js" type="text/javascript"></script>
	<script src="assets/js/material.min.js" type="text/javascript"></script>

	<script src="api.js"></script>


	<script>
        var api = new API();


        var pageTriggers = [];

        function switchPage(pageID){
            console.info("Page switched to "+pageID);
            $('.main-panel .content .container-fluid').addClass("hidden");
            $('.sidebar-wrapper ul li').removeClass("active");
            $('#page_'+pageID).removeClass("hidden");
            $('.navigation_'+pageID).addClass("active");
            if(typeof pageTriggers[pageID] == "function"){
                pageTriggers[pageID]();
            }
        }

        pageTriggers["pages"] = function(){
            api.getDatamodelPageTypes(function(succData,failData,e1,e2,e3){
				var pgsTL = $("#pagesPagesTypesList").html("");
				if(succData&&!failData){
                    succData["data"].forEach(function (value, key, array) {
                        pgsTL.append('<li data-pageid="'+value["id"]+'"><a role="tab" data-toggle="tab" onclick="redrawPagesWithFilters();"><i class="material-icons">'+value["icon"]+'</i>'+value["name"]+'</a></li>');
					})
                }else{
				    console.error("Failed to load Datamodel Page Types",failData,e1,e2,e3);
				    // TODO : show error
                }
			});
            redrawPagesWithFilters();
        };

        function redrawPagesWithFilters(){
            var filter = [];
            // FIXME this is demo version
            var activePageType = $("#pagesPagesTypesList .active");
            if(typeof activePageType.getAttribute == "function"){
                var typeID = activePageType.getAttribute("data-pageid");
                if(typeID !== null) filter.push({"type":typeID});
			}
            api.getPages(filter,function(succData,failData,e1,e2,e3){
                console.log(succData,failData,e1,e2,e3);
            });
		}

        function loadPageByHASH(){
            var h = window.location.hash.substring(1);
            if(h=="statistics"||h=="pages"||h=="navigation"||h=="development"||h=="datamodel"||h=="settings"||h=="users"){
                switchPage(h);
            } // TODO analyse subpages

        }

		window.onload = function(){
			loadPageByHASH();
		};
		$(window).on('hashchange', function() {
			loadPageByHASH();
		});
	</script>

	<!--  Charts Plugin -->
	<script src="assets/js/chartist.min.js"></script>

	<!--  Notifications Plugin    -->
	<script src="assets/js/bootstrap-notify.js"></script>

	<!--  Google Maps Plugin    -->
	<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js"></script>

	<!-- Material Dashboard javascript methods -->
	<script src="assets/js/material-dashboard.js"></script>

	<!-- Material Dashboard DEMO methods, don't include it in your project! -->
	<script src="assets/js/demo.js"></script>

	<script type="text/javascript">
    	$(document).ready(function(){

			// Javascript method's body can be found in assets/js/demos.js
        	demo.initDashboardPageCharts();

    	});
	</script>

</html>
